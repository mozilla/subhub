FROM mozilla/subhub-base:latest
MAINTAINER Stewart Henderson <shenderson@mozilla.com>

ARG STRIPE_API_KEY
ARG AWS_ACCESS_KEY_ID
ARG AWS_SECRET_ACCESS_KEY
ARG LOCAL_FLASK_PORT
ARG SUPPORT_API_KEY
ARG DYNALITE_PORT

ENV STRIPE_API_KEY=$STRIPE_API_KEY
ENV AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID
ENV AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY
ENV LOCAL_FLASK_PORT=$LOCAL_FLASK_PORT
ENV HUB_API_KEY=$HUB_API_KEY
ENV DYNALITE_PORT=$DYNALITE_PORT
ENV FLASK_ENV=development

EXPOSE $LOCAL_FLASK_PORT

RUN mkdir -p /subhub
ADD .src.tar.gz /subhub/hub
WORKDIR /subhub
ENV PYTHONPATH=.
