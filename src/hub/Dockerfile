FROM mozilla/subhub-base:latest
MAINTAINER Stewart Henderson <shenderson@mozilla.com>

ARG STRIPE_API_KEY
ARG AWS_ACCESS_KEY_ID
ARG AWS_SECRET_ACCESS_KEY
ARG LOCAL_FLASK_PORT
ARG SUPPORT_API_KEY

ENV STRIPE_API_KEY=$STRIPE_API_KEY
ENV AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID
ENV AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY
ENV LOCAL_FLASK_PORT=$LOCAL_FLASK_PORT
ENV SUPPORT_API_KEY=$SUPPORT_API_KEY
ENV FLASK_ENV=development

ENV DEPLOYED_ENV=local
ENV BRANCH=local
ENV REVISION=latest
ENV VERSION=latest
ENV PROJECT_NAME=subhub
ENV REMOTE_ORIGIN_URL=git@github.com:mozilla/subhub.git

EXPOSE $LOCAL_FLASK_PORT

RUN mkdir -p /subhub/hub
ADD .src.tar.gz /subhub/hub
WORKDIR /subhub/
