FROM mozilla/subhub-base:latest
MAINTAINER Stewart Henderson <shenderson@mozilla.com>

ARG STRIPE_API_KEY
ARG AWS_ACCESS_KEY_ID
ARG AWS_SECRET_ACCESS_KEY
ARG LOCAL_FLASK_PORT
ARG SUPPORT_API_KEY
ARG DYNALITE_PORT

ENV STRIPE_API_KEY=$STRIPE_API_KEY \
    AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID \
    AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY \
    LOCAL_FLASK_PORT=$LOCAL_FLASK_PORT \
    SUPPORT_API_KEY=$SUPPORT_API_KEY \
    PAYMENT_API_KEY=$PAYMENT_API_KEY \
    DYNALITE_PORT=$DYNALITE_PORT \
    LOG_LEVEL=$LOG_LEVEL \
    FLASK_ENV=development

EXPOSE $LOCAL_FLASK_PORT

RUN mkdir -p /subhub
ADD .src.tar.gz /subhub/sub
WORKDIR /subhub
ENV PYTHONPATH=.
